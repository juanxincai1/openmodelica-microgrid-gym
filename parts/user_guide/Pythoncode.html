

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Toolbox Installation and General Remarks &mdash; OpenModelica Microgrid 2020 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Examples" href="examples.html" />
    <link rel="prev" title="Functional Mock-up Unit (FMU)" href="fmu.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> OpenModelica Microgrid
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">User Guide:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="OpenModelica.html">OpenModelica</a></li>
<li class="toctree-l1"><a class="reference internal" href="fmu.html">Functional Mock-up Unit (FMU)</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Toolbox Installation and General Remarks</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="controller_tuning.html">Controller Tuning Hints</a></li>
</ul>
<p class="caption"><span class="caption-text">API:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api/omg.agents.html">omg.agents</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/omg.aux_ctl.html">omg.aux_ctl</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/omg.env.html">omg.env</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/omg.execution.html">omg.execution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/omg.net.html">omg.net</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/omg.util.html">omg.util</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">OpenModelica Microgrid</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Toolbox Installation and General Remarks</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/parts/user_guide/Pythoncode.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="toolbox-installation-and-general-remarks">
<h1>Toolbox Installation and General Remarks<a class="headerlink" href="#toolbox-installation-and-general-remarks" title="Permalink to this headline">¶</a></h1>
<p>In the following, some installation hints and an introduction to the Python code written for the OMG
toolbox is presented.</p>
<div class="section" id="installation-and-requirements">
<h2>Installation and Requirements<a class="headerlink" href="#installation-and-requirements" title="Permalink to this headline">¶</a></h2>
<p>This is the short installation guide for Windows and Linux. <a class="reference external" href="https://openmodelica.org/download/download-mac">OpenModelica</a> is hardly supported for Mac, they suggest to install in a Linux VM. For this reason, running OMG in a Linux <a class="reference external" href="https://openmodelica.org/download/virtual-machine">VM</a> is strongly recommended for Mac users!</p>
<p>It is recommended to install OMG via pip:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">openmodelica_microgrid_gym</span>
</pre></div>
</div>
<p>Alternatively, you can clone the GitHub repository. A list of
requirements is provided in the
home-directory.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">## created with pipreqs</span>
<span class="n">gym</span><span class="o">&gt;=</span><span class="mf">0.15.3</span>
<span class="n">numpy</span><span class="o">&gt;=</span><span class="mf">1.17.2</span>
<span class="n">matplotlib</span><span class="o">&gt;=</span><span class="mf">3.1.1</span>
<span class="n">scipy</span><span class="o">&gt;=</span><span class="mf">1.3.1</span>
<span class="n">pandas</span><span class="o">&gt;=</span><span class="mf">1.0.1</span>
<span class="n">tqdm</span><span class="o">&gt;=</span><span class="mi">4</span>
<span class="n">more_itertools</span><span class="o">&gt;=</span><span class="mi">7</span>
<span class="n">numexpr</span><span class="o">&gt;=</span><span class="mf">2.7.1</span>
<span class="n">tables</span><span class="o">&gt;=</span><span class="mf">3.6.1</span>
<span class="n">stochastic</span><span class="o">&gt;=</span><span class="mf">0.6.0</span>

<span class="n">pyyaml</span><span class="o">~=</span><span class="mf">5.4</span>

<span class="n">PyFMI</span><span class="o">&gt;=</span><span class="mf">2.5</span>

<span class="n">safeopt</span><span class="o">&gt;=</span><span class="mf">0.16</span>
<span class="n">GPy</span><span class="o">&gt;=</span><span class="mf">1.9.9</span>

<span class="n">future</span><span class="o">~=</span><span class="mf">0.18.2</span>
<span class="n">pytest</span><span class="o">~=</span><span class="mf">5.4.3</span>
<span class="n">setuptools</span><span class="o">~=</span><span class="mf">47.1.1</span>
</pre></div>
</div>
<p><strong>Hint:</strong> If you are running a windows, PyFMI might throw some errors
while installing via pip. It can be installed via <em>conda</em> by running:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">install</span> <span class="o">-</span><span class="n">c</span> <span class="n">conda</span><span class="o">-</span><span class="n">forge</span> <span class="n">pyfmi</span>
</pre></div>
</div>
</div>
<div class="section" id="simulation-settings">
<h2>Simulation Settings<a class="headerlink" href="#simulation-settings" title="Permalink to this headline">¶</a></h2>
<p>Heart of the program structure is the creation of the environment via
<strong>gym.make()</strong> in the main programm (in the folder example). Nearly
every simulation setting can be done directly in here. Some of the most
important ones are described in the following. For further information, see the <a class="reference external" href="../../api/omg.env.modelica.html">API-documentation</a>.</p>
<ul class="simple">
<li><p><strong>time_step:</strong> step size of the simulation in seconds. Too large
timesteps may result in numerical issues, small timesteps result in a
high simulation time. 1e-4 seems to be a good compromise as many real
controllers operate in timesteps like this.</p></li>
<li><p><strong>reward_fun:</strong> Callable - Reward function for the RL-algorithm. Minimal value
of rewards is for example used as lower bound for the safe Bayseian
algorithm (see single_inverter_current_control_safe_opt.py). Has to be adjusted problem-specific.</p></li>
<li><p><strong>solver_method:</strong> Solver used for the ODE system. Every solver from
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.solve_ivp.html">scipy.integrate.solve_ivp</a>
can be selected. Though it is highly recommended to use the implicit
ones. Default solver is the “LSODA” with its integrated stiffness
detection. Non-stiff systems become solved with the faster “Adams”
method, stiff systems with “BDF”.</p></li>
<li><p><strong>model_params:</strong> Parameters for the simulation, which should be
changed compared to the default values from the OpenModelica model.
Also usable for loadsteps as replacement for
<a class="reference external" href="OpenModelica.md">switches</a>.</p></li>
</ul>
<p>Example which increases the resistors in the load after 0.2 seconds from
20 Ohm to 40 Ohm:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">20</span> <span class="k">if</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="mf">.2</span> <span class="k">else</span> <span class="mi">40</span>

<span class="n">model_params</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;rl.resistor1.R&#39;</span><span class="p">:</span> <span class="n">f</span><span class="p">,</span> <span class="s1">&#39;rl.resistor.R&#39;</span><span class="p">:</span> <span class="n">f</span><span class="p">,</span> <span class="s1">&#39;rl.resistor.R&#39;</span><span class="p">:</span> <span class="n">f</span><span class="p">},</span>
</pre></div>
</div>
<p>The function <code class="code docutils literal notranslate"><span class="pre">f</span></code> is passed as a callable (function reference).
The environment will evaluate this function in every timestep passing this timestep as parameter to the function
automatically.</p>
</div>
<div class="section" id="setting-of-v-dc">
<h2>Setting of v_DC<a class="headerlink" href="#setting-of-v-dc" title="Permalink to this headline">¶</a></h2>
<p>The DC supply voltage v_DC can be set either directly in the
<a class="reference external" href="OpenModelica.html#setting-of-v-dc">OpenModelica model</a> or via
Python. The default value is 1000 V. It can be changed in the
environment creation with the line:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model_params</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;inverter1.v_DC&#39;</span><span class="p">:</span> <span class="mi">700</span><span class="p">,</span> <span class="s1">&#39;inverter2.v_DC&#39;</span><span class="p">:</span> <span class="mi">500</span><span class="p">},</span>
</pre></div>
</div>
<p>It will be set for every of the three phases of the inverter. Take care
to set the param for every inverter which should no have the default
supply voltage of 1000 V.</p>
</div>
<div class="section" id="data-logging">
<h2>Data Logging<a class="headerlink" href="#data-logging" title="Permalink to this headline">¶</a></h2>
<p>To enable logging, the root logger needs to be initialized in the
main function. To do so, call:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">()</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">ctrl</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</pre></div>
</div>
<p>For further information about logging and the level see the <a class="reference external" href="https://docs.python.org/3/library/logging.html">logging
standard library</a>.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="examples.html" class="btn btn-neutral float-right" title="Examples" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="fmu.html" class="btn btn-neutral float-left" title="Functional Mock-up Unit (FMU)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020, Bode, Heid, Wallscheid, Weber.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>